<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- bootstrap css -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

        <!-- our css -->
        <link href="../css/styles.css" rel="stylesheet">

        <title> - Cardiff Vocaloid Society</title>
    </head>
    <body>

        <style>
            /* Default (landscape): Two columns using Bootstrap's grid */
          
            /* Set default order */
            .reorder-1 { order: 1; }  /* About Us */
            .reorder-2 { order: 2; }  /* Events */
            .reorder-3 { order: 3; }  /* Haider Blog */
          
            /* Portrait layout */
            @media (max-aspect-ratio: 1/1) {
              #responsive-layout {
                display: flex;
                flex-direction: column;
              }
          
              .reorder-1 { order: 1 !important; }  /* About Us (top) */
              .reorder-2 { order: 2 !important; }  /* Events (middle) */
              .reorder-3 { order: 3 !important; }  /* Haider Blog (bottom) */
          
              .col-lg-6 {
                width: 100% !important;
                max-width: 100% !important;
              }
            }
          </style>

        <!-- navbar -->
        <nav class="navbar navbar-expand-lg">
            <div class="container-fluid">
                <a class="navbar-brand bold-text" href="#">
                    <img src="../images/Logo_Pride_Expanded.png" alt="Cardiff Vocaloid Society's Logo" width="60" height="60" class="d-inline-block align-text-centre">
                    Cardiff Vocaloid Society
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#vocanav" aria-controls="vocanav"
                aria-expanded="false"
                aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="vocanav">
                    <div class="navbar-nav">
                        <a class="nav-link" href="#">Home</a>
                        <a class="nav-link" href="events.html">Events</a>
                        <a class="nav-link" href="https://www.cardiffstudents.com/activities/society/vocaloidsociety/">SU Page</a>
                        <a class="nav-link" href="#">Gallery</a>
                        <a class="nav-link" href="https://linktr.ee/cardiffvocaloid">Linktree</a>
                    </div>
                </div>
            </div>
        </nav>

        <div id="main-page-grid" class="container">
            <div id="responsive-layout" class="row d-flex flex-wrap align-items-stretch">
          
              <!-- About Us: Top in both modes -->
              <div id="about-us" class="col-lg-6 reorder-1">
                <div class="text-center">
                  <h3>About Us</h3>
                </div>
                <div class="text-center">
                  <p>
                    teto worship. teto worship. teto worship. teto worship. teto worship.
                  </p>
                </div>
              </div>
          
              <!-- Events List: Left in landscape, middle in portrait -->
              <div id="events" class="col-lg-6 reorder-2">
                <div class="text-center">
                  <h3>Upcoming Events</h3>
                </div>
                <div id="eventsList">
                  <!-- Events will be displayed here -->
                </div>
              </div>
          
              <!-- Haider Blog: Bottom in portrait, below About Us in landscape -->
              <div id="haider-blog" class="col-lg-6 reorder-3">
                <div class="text-center">
                  <h3>Haider Blog Post</h3>
                </div>
                <div class="text-center">
                  <p>too busy aura farming, will write later</p>
                </div>
              </div>
          
            </div>
          </div>

        <br><br><br><br><br><br>
        <div id="main-page-grid" class="container">
            <!-- contents go here. duh!-->
            <div class="row">
                <div id="events" class="col">
                    <div class="text-center">
                        <h3>Upcoming Events</h3>
                    </div>
                    <div id="eventsList">
                        <!-- Events will be displayed here -->
                    </div>
                </div>
                <div class="col">
                    <div id="about-us" class="row">
                        <div class="text-center">
                            <h3>About Us</h3>
                        </div>
                        <div class="text-center">
                            <p>teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship. teto worship.</p>
                        </div>
                    </div>
                    <div id="haider-blog" class="row">
                        <div class="text-center">
                            <h3>Haider Blog Post</h3>
                        </div>
                        <div class="text-center">
                            <p>too busy aura farming, will write later</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
            <footer class="text-center fixed-bottom">
                <div class="text-center p-3">
                    <p class="text-body">Miku Miku Beam!</p>
                </div>
            </footer>
        </div>

        <script>
            // Function to get the ordinal suffix
            function getOrdinalSuffix(day) {
                if (day > 3 && day < 21) return 'th'; // Handle 11th, 12th, 13th, etc.
                switch (day % 10) {
                case 1: return 'st';
                case 2: return 'nd';
                case 3: return 'rd';
                default: return 'th';
                }
            }

            function addHours(date, hours) {
                date.setHours(date.getHours() + hours);
                return date;
            }

            function isDateGreaterThanToday(date) {
                // Get today's date at midnight (ignoring the time part)
                const today = new Date();
                today.setHours(0, 0, 0, 0); // Set time to 00:00:00
            
                // Compare the dates (get the time in milliseconds)
                return new Date(date) > today;
            }

            // Fetch the JSON file using fetch API
            fetch('../data/socials.json')
                .then(response => response.json())  // Parse the JSON response
                .then(events => {
                    // Loop through the events and display each one
                    const eventsListContainer = document.getElementById('eventsList');
                    var eventsDisplayed = 0
                    events.forEach(event => {
                        if (isDateGreaterThanToday(event.date) == true && eventsDisplayed < 3) {
                            // Convert date to more readable formats
                            const eventDate = new Date(event.date);
                            const eventDayName = eventDate.toLocaleDateString('en-GB', { weekday: 'long' });
                            const eventDayNumber = eventDate.getDate() + getOrdinalSuffix(eventDate.getDate());
                            const eventMonth = eventDate.toLocaleString('en-GB', { month: 'short' });
                            const eventTime = eventDate.toLocaleTimeString('en-GB', { hour12: false, hour: '2-digit', minute: '2-digit' });
                            const eventEndTime = addHours(eventDate, event.length).toLocaleTimeString('en-GB', { hour12: false, hour: '2-digit', minute: '2-digit' });

                            // Create new divs for each event
                            const dateDiv = document.createElement('div');
                            dateDiv.classList.add('date-box', 'col-4');

                            const eventDiv = document.createElement('div');
                            eventDiv.classList.add('event-box', 'col-8');

                            // Add details to the divs
                            dateDiv.innerHTML = `
                                <p>
                                    <b style="font-size: var(--space-xs);">${eventDayName}</b>
                                    <br>
                                    <b style="font-size: var(--space-s-l);">${eventDayNumber} ${eventMonth}</b>
                                    <br>
                                    <b style="font-size: var(--space-xs-s);">${eventTime} - ${eventEndTime}</b>
                                </p>
                            `;

                            eventDiv.innerHTML = `
                            <p>
                                <b style="font-size: var(--space-s-l);">${event.title}</b>
                                <p>${event.description}</p>
                                <p><strong>Category:</strong> ${event.category}</p>
                            </p>
                            `;

                            // Create a div for the row
                            const rowDiv = document.createElement('div');
                            rowDiv.classList.add('row-box', 'row', 'row-cols-6');

                            // Append the divs to the row
                            rowDiv.appendChild(dateDiv);
                            rowDiv.appendChild(eventDiv);
                            
                            // Append the row to the events container
                            eventsListContainer.appendChild(rowDiv);
                        }
                        eventsDisplayed = eventsDisplayed + 1;
                    });
                })
                .catch(error => console.error('Error loading JSON:', error));
        </script>
    
        <!-- scripts required for bootstrap -->
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    </body>
</html>