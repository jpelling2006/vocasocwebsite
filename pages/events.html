<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- bootstrap css -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

        <!-- our css -->
        <link href="css/styles.css" rel="stylesheet">

        <title> - Cardiff Vocaloid Society</title>
    </head>
    <style>
        .date-box {
            background-color: #a7c7e7;  /* Light pastel blue */
            text-align: center;         /* Center the text */
            padding: var(--space-s-l);

        }

        .event-box {
            background-color: #e7a7a7;  /* Light pastel blue */
            text-align: center;         /* Center the text */
            padding: var(--space-s-l);
        }

        .row-box {
            border: 1px solid black;
        }
    </style>
    
    <body>
        <h1 style="font-size:var(--step-4);">Events</h1>    


        <div class="container">
            <div class="row">
              <div class="col">
                <h1 style="font-size: var(--step--2); margin-bottom: var(--space-s);">Responsive Title</h1>
                <p style="font-size: var(--step-0); margin-bottom: var(--space-xs);">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
              </div>
            </div>
          </div>

        <br>

        <div class="container" id="eventList">
            <!-- Events will be displayed here -->
        </div>
        
        <script>
            // Function to get the ordinal suffix
            function getOrdinalSuffix(day) {
                if (day > 3 && day < 21) return 'th'; // Handle 11th, 12th, 13th, etc.
                switch (day % 10) {
                case 1: return 'st';
                case 2: return 'nd';
                case 3: return 'rd';
                default: return 'th';
                }
            }         

            // Fetch the JSON file using fetch API
            fetch('../data/socials.json')
                .then(response => response.json())  // Parse the JSON response
                .then(events => {
                    // Loop through the events and display each one
                    const eventListContainer = document.getElementById('eventList');
                    events.forEach(event => {
                        // Convert date to more readable formats
                        const eventDate = new Date(event.date);
                        const eventDayName = eventDate.toLocaleDateString('en-GB', { weekday: 'long' });
                        const eventDayNumber = eventDate.getDate() + getOrdinalSuffix(eventDate.getDate());
                        const eventMonth = eventDate.toLocaleString('en-GB', { month: 'short' });
                        const eventTime = eventDate.toLocaleTimeString('en-GB', { hour12: false, hour: '2-digit', minute: '2-digit' });


                        // Create new divs for each event
                        const dateDiv = document.createElement('div');
                        dateDiv.classList.add('date-box', 'col');

                        const eventDiv = document.createElement('div');
                        eventDiv.classList.add('event-box', 'col');

                        // Add details to the divs
                        dateDiv.innerHTML = `
                            ${eventDayName}
                            <br>
                            ${eventDayNumber} ${eventMonth}
                            <br>
                            ${eventTime}
                        `;

                        eventDiv.innerHTML = `
                            <h2>${event.title}</h2>
                            <p><strong>Category:</strong> ${event.category}</p>
                        `;
                        

                        const rowDiv = document.createElement('div');
                        rowDiv.classList.add('row-box', 'row', 'row-cols-2');

                        // Append the divs to the event list container
                        rowDiv.appendChild(dateDiv);
                        rowDiv.appendChild(eventDiv);

                        eventListContainer.appendChild(rowDiv);
                    });
                })
                .catch(error => console.error('Error loading JSON:', error));
        </script>
        

        <!-- scripts required for bootstrap -->
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    </body>
</html>